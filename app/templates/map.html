{% extends "layout.html" %}
{% block title %}Ãœbersicht Fundmeldungen {% endblock title %}
{% block content %}
<div class="container flex flex-row p-6 mx-auto">
    <div id="map" class="object-fill h-screen grow auto-rows-max"></div>
</div>
<script>
    const mapApiKey = ""; // https://arcgis.esri.de/dos-and-donts-was-ist-wichtig-im-umgang-mit-esri-basemaps/

    const map = L.map('map').setView([51.991649, 13.080113], 7);

    const openStreetMapLayer = L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
    });

    const arcGISLayer = L.esri.Vector.vectorBasemapLayer("ArcGIS:Imagery", {
        apikey: mapApiKey // Corrected here
    });

    // Add default layer to the map
    map.addLayer(openStreetMapLayer);

    var reports = JSON.parse('{{ reportsJson | safe }}');
    for (var i = 0; i < reports.length; i++) {
        var report = reports[i];
        const marker = L.marker([report.latitude, report.longitude]).addTo(map)
    };

    // Layer switcher control
    var baseMaps = {
        "OpenStreetMap": openStreetMapLayer,
        "ArcGIS": arcGISLayer
    };

    L.control.layers(baseMaps).addTo(map);
</script>
{% endblock content %}