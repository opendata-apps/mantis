{% extends "layout.html" %}
{% block title %}Fundmeldungen 2023{% endblock title %}
{% block text %} Übersicht zu allen bestätigten Meldungen. {% endblock text %}
{% block content %}
<section class="container mx-auto mt-10">
  <h2 class="mb-6 text-3xl font-semibold text-center">Bestätigte Meldungen Karte</h2>
  <div class="container flex flex-row p-6">
    <div id="map" class="object-fill h-screen bg-white rounded-lg shadow-md grow auto-rows-max"></div>
  </div>
</section>
<div id="map" class="h-64 border shadow-md sm:h-96 lg:h-96"></div>

  <script>
    // First Map:
    let map;
    let userMarker;
    mapApiKey = "{{apikey}}"

    function initMap() {
      map = L.map('map').setView([51.991649, 13.080113], 9);

      // Define map layers
      const openStreetMapLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
        maxZoom: 11,
      });

      const arcGISLayer = L.esri.Vector.vectorBasemapLayer("ArcGIS:Imagery", {
        apikey: mapApiKey // Add your actual API key here
      });

      // Add default layer to the map
      map.addLayer(openStreetMapLayer);

      // Layer switcher control
      var baseMaps = {
        "Karte": openStreetMapLayer,
        "Satellit": arcGISLayer
      };

	L.control.layers(baseMaps).addTo(map);

	var reports = JSON.parse('{{ reportsJson | safe }}');
	for (var i = 0; i < reports.length; i++) {
	    var report = reports[i];
	    const marker = L.marker([report.longitude, report.latitude]).addTo(map)
	};
    };
    initMap();
    </script>
  
{% endblock content %}
