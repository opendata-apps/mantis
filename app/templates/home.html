{% extends "layout.html" %}
{% block page_title %}Gottesanbeterin gesucht! | Mitmachprojekt Brandenburg & Berlin{% endblock %}
{% block meta_description %}Melden Sie Sichtungen der Europäischen Gottesanbeterin (Mantis religiosa) in Brandenburg & Berlin. Foto hochladen, Fundort markieren und Forschung unterstützen.{% endblock %}
{% block meta_keywords %}Gottesanbeterin melden, Mantis religiosa melden, Sichtung melden, Brandenburg, Berlin, Oothek, Nymphe, Fangschrecke{% endblock %}
{% block canonical %}{{ url_for('main.index', _external=True) }}{% endblock %}

{% block og_meta %}
<meta property="og:title" content="Gottesanbeterin gesucht! – Mitmachprojekt Brandenburg & Berlin" />
<meta property="og:type" content="website" />
<meta property="og:url" content="{{ url_for('main.index', _external=True) }}" />
<meta property="og:image" content="{{ url_for('static', filename='images/berger03.avif', _external=True) }}" />
<meta property="og:description" content="Melden Sie Sichtungen der Europäischen Gottesanbeterin (Mantis religiosa) in Brandenburg & Berlin – helfen Sie Forschung und Kartierung." />
<meta property="og:site_name" content="Gottesanbeterin Gesucht" />
<meta property="og:locale" content="de_DE" />
{% endblock %}

{% block twitter_meta %}
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Gottesanbeterin gesucht! – Mitmachprojekt Brandenburg & Berlin" />
<meta name="twitter:description" content="Sichtungen melden, Fotos teilen und die Verbreitung der Gottesanbeterin erforschen helfen." />
<meta name="twitter:image" content="{{ url_for('static', filename='images/berger03.avif', _external=True) }}" />
<meta name="twitter:url" content="{{ url_for('main.index', _external=True) }}" />
{% endblock %}

{% block head %}
{{ super() }}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "Gottesanbeterin Gesucht",
  "url": "{{ url_for('main.index', _external=True) }}",
  "logo": "{{ url_for('static', filename='images/favicon/apple-touch-icon.png', _external=True) }}"
}
</script>
{% endblock %}

{% block title %}Gottesanbeterin gesucht!{% endblock title %}
{% from "macro.html" import popover %}
{% block content %}
<p style="text-align:center">Zeit der Eiablage: Melden Sie bitte auch Ootheken, sie sind der Start für die nächste Generation im kommenden Jahr.</p>
<!--Projektbeschreibung section -->
<section id="Projektbeschreibung" class="overflow-hidden relative px-4 py-20 sm:px-6 lg:px-8">
    <div class="mx-auto max-w-7xl">
        <div class="space-y-32">
            <!-- Section 1 -->
            <div class="relative">
                <div class="items-center lg:grid lg:grid-cols-2 lg:gap-12">
                    <div class="relative mb-8 lg:row-start-1 lg:col-start-2 lg:mb-0">
                        <div class="overflow-hidden rounded-2xl shadow-2xl aspect-w-3 aspect-h-2 group">
                            <img src="{{ url_for('static', filename='images/weibchen-mit-oothek.avif') }}"
                                alt="Gottesanbeterin bei der Eiablage (Oothek)"
                                class="object-cover object-center w-full h-full transition-transform duration-700 group-hover:scale-105"
                                loading="lazy" />
                            <div
                                class="absolute inset-0 bg-black bg-opacity-20 opacity-0 transition-opacity duration-300 group-hover:opacity-100">
                            </div>
                        </div>
                        <!-- Decorative Camera Icon -->
                        <div
                            class="absolute top-0 right-0 p-3 bg-white rounded-full shadow-lg transform translate-x-1/2 -translate-y-1/2">
                            <svg class="w-8 h-8 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" />
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M15 13a3 3 0 11-6 0 3 3 0 016 0z" />
                            </svg>
                        </div>
                    </div>
                    <div class="relative lg:row-start-1 lg:col-start-1">
                        <h2
                            class="pb-6 text-3xl font-bold tracking-tight text-transparent bg-clip-text bg-gradient-to-r from-green-600 to-green-400 sm:text-4xl">
                            Gottesanbeterin gesucht! -Projekt
                        </h2>
                        <p class="mb-6 text-lg leading-relaxed text-gray-700">
                            Das
                            <span class="font-semibold text-green-600">Naturkundemuseum Potsdam</span>
                            und die
                            <span class="font-semibold text-green-600">Mantidenfreunde Berlin-Brandenburg</span>
                            initiieren das Projekt "Gottesanbeterin gesucht!" mit dem Ziel,
                            die
                            <span class="font-semibold text-green-600">Europäische Gottesanbeterin</span>
                            (<i>Mantis religiosa</i> L. 1758) in der Region Brandenburg zu
                            kartieren. Seit 2016 sammeln wir
                            <span class="font-semibold text-green-600">Fundmeldungen</span>
                            dieser speziellen Fangschreckenart und bitten Sie, uns bei der
                            Erforschung ihrer
                            <span class="font-semibold text-green-600">Ausbreitung</span> zu
                            unterstützen.
                        </p>
                        <a href="https://www.naturkundemuseum-potsdam.de/gottesanbeterin-gesucht" target="_blank"
                            class="inline-flex overflow-hidden relative items-center px-6 py-3 text-base font-medium text-white bg-green-500 rounded-lg shadow-md transition duration-300 group hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500">
                            <span class="relative z-10">Mehr erfahren</span>
                            <svg class="-mr-1 ml-2 w-5 h-5 transition-transform duration-300 group-hover:translate-x-1"
                                xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"
                                aria-hidden="true">
                                <path fill-rule="evenodd"
                                    d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z"
                                    clip-rule="evenodd" />
                            </svg>
                            <div
                                class="absolute inset-0 w-full h-full rounded-lg transition-all duration-300 scale-0 group-hover:scale-100 group-hover:bg-white/10">
                            </div>
                        </a>
                    </div>
                </div>
            </div>

            <!-- Section 2 -->
            <div class="relative">
                <div class="items-center lg:grid lg:grid-cols-2 lg:gap-12">
                    <div class="relative mb-8 lg:mb-0">
                        <div class="overflow-hidden rounded-2xl shadow-2xl aspect-w-3 aspect-h-2 group">
                            <img src="{{ url_for('static', filename='images/berger03.avif') }}"
                                alt="Gottesanbeterin nahaufnahme"
                                class="object-cover object-center w-full h-full transition-transform duration-700 group-hover:scale-105"
                                loading="lazy" />
                            <div
                                class="absolute inset-0 bg-black bg-opacity-20 opacity-0 transition-opacity duration-300 group-hover:opacity-100">
                            </div>
                        </div>
                        <!-- Decorative Icon -->
                        <div
                            class="absolute bottom-0 left-0 p-3 bg-white rounded-full shadow-lg transform translate-x-1/4 translate-y-1/4">
                            <svg class="w-8 h-8 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01">
                                </path>
                            </svg>
                        </div>
                    </div>
                    <div class="relative">
                        <h2
                            class="pb-6 text-3xl font-bold tracking-tight text-transparent bg-clip-text bg-gradient-to-r from-green-600 to-green-400 sm:text-4xl">
                            <i>Mantis religiosa</i> L. 1758
                        </h2>
                        <p class="mb-6 text-lg leading-relaxed text-gray-700">
                            Die
                            <span class="font-semibold text-green-600">Europäische Gottesanbeterin</span>
                            ist die einzige Art unter etwa 2.400 Fangschrecken-Arten, die in
                            Deutschland, insbesondere in
                            <span class="font-semibold text-green-600">Brandenburg</span>,
                            vorkommt. Mit ihren zum Gebet gefalteten Vorderbeinen
                            unterscheidet sie sich deutlich von anderen Insekten. Ihre
                            <span class="font-semibold text-green-600">geschickte und gut getarnte Lebensweise</span>
                            macht die Suche nach ihr jedoch anspruchsvoll, daher sind wir auf
                            Ihre
                            <span class="font-semibold text-green-600">Meldungen</span>
                            angewiesen.
                        </p>
                        <a href="/mantis-religiosa"
                            class="inline-flex overflow-hidden relative items-center px-6 py-3 text-base font-medium text-white bg-green-500 rounded-lg shadow-md transition duration-300 group hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500">
                            <span class="relative z-10">Mehr über Mantis religiosa</span>
                            <svg class="-mr-1 ml-2 w-5 h-5 transition-transform duration-300 group-hover:translate-x-1"
                                xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"
                                aria-hidden="true">
                                <path fill-rule="evenodd"
                                    d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z"
                                    clip-rule="evenodd" />
                            </svg>
                            <div
                                class="absolute inset-0 w-full h-full rounded-lg transition-all duration-300 scale-0 group-hover:scale-100 group-hover:bg-white/10">
                            </div>
                        </a>
                    </div>
                </div>
            </div>

            <!-- Section 3 -->
            <div class="relative">
                <div class="items-center lg:grid lg:grid-cols-2 lg:gap-12">
                    <div class="relative mb-8 lg:row-start-1 lg:col-start-2 lg:mb-0">
                        <div class="overflow-hidden rounded-2xl shadow-2xl aspect-w-3 aspect-h-2 group">
                            <img src="{{ url_for('static', filename='images/berger10.avif') }}"
                                alt="Gottesanbeterin in ihrem Lebensraum"
                                class="object-cover object-center w-full h-full transition-transform duration-700 group-hover:scale-105"
                                loading="lazy" />
                            <div
                                class="absolute inset-0 bg-black bg-opacity-20 opacity-0 transition-opacity duration-300 group-hover:opacity-100">
                            </div>
                        </div>
                        <!-- Floating Element -->
                        <div
                            class="absolute top-0 left-0 p-3 bg-white rounded-full shadow-lg transform -translate-x-1/4 -translate-y-1/4">
                            <svg class="w-8 h-8 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                            </svg>
                        </div>
                    </div>
                    <div class="relative lg:row-start-1 lg:col-start-1">
                        <h2
                            class="pb-6 text-3xl font-bold tracking-tight text-transparent bg-clip-text bg-gradient-to-r from-green-600 to-green-400 sm:text-4xl">
                            Was passiert mit meiner Meldung?
                        </h2>
                        <p class="mb-6 text-lg leading-relaxed text-gray-700">
                            Jede
                            <span class="font-semibold text-green-600">Meldung</span> einer in
                            Brandenburg gefundenen Gottesanbeterin wird überprüft und in einer
                            <span class="font-semibold text-green-600">Datenbank</span>
                            erfasst. Ihr Bild dient ausschließlich zur Bestätigung des Fundes
                            und wird in keiner Form weiterverwendet oder veröffentlicht. Mit
                            Hilfe Ihrer wertvollen Informationen können wir
                            <span class="font-semibold text-green-600">Verbreitungskarten</span>
                            erstellen, welche die aktuelle
                            <span class="font-semibold text-green-600">Ausbreitung</span> der
                            Gottesanbeterin in Brandenburg zeigen.
                        </p>
                        <a href="/faq"
                            class="inline-flex overflow-hidden relative items-center px-6 py-3 text-base font-medium text-white bg-green-500 rounded-lg shadow-md transition duration-300 group hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500">
                            <span class="relative z-10">FAQ lesen</span>
                            <svg class="-mr-1 ml-2 w-5 h-5 transition-transform duration-300 group-hover:translate-x-1"
                                xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"
                                aria-hidden="true">
                                <path fill-rule="evenodd"
                                    d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z"
                                    clip-rule="evenodd" />
                            </svg>
                            <div
                                class="absolute inset-0 w-full h-full rounded-md transition-all duration-300 scale-0 group-hover:scale-100 group-hover:bg-white/10">
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Animated counter section -->
<section class="py-16 bg-gray-100">
    <div class="container px-4 mx-auto">
        <div class="relative px-8 py-12 bg-green-800 rounded-lg shadow-2xl">
            <h2 class="mb-8 text-3xl font-bold leading-tight text-center text-gray-100">
                Wir haben insgesamt <br />
                <span class="text-7xl font-extrabold text-gray-100 counter" data-target="{{ post_count }}">0</span>
                <br />
                Meldungen erhalten
            </h2>
            <p class="mb-8 text-xl text-center text-gray-100">
                Helfen Sie uns, diese Zahl zu erhöhen!
            </p>
        </div>
    </div>
</section>

<script>
  // Counter animation with performance optimization
  const counter = document.querySelector('.counter');
  const target = +counter.dataset.target;
  const duration = 2000;
  const frameRate = 1000 / 30; // 30 FPS
  let startTime = null;

  function easeOutExpo(t) {
    return t === 1 ? 1 : 1 - Math.pow(2, -10 * t);
  }

  function animateCounter(currentTime) {
    if (!startTime) startTime = currentTime;
    const elapsedTime = currentTime - startTime;
    const progress = Math.min(elapsedTime / duration, 1);
    
    if (progress < 1) {
      const nextValue = Math.floor(easeOutExpo(progress) * target);
      if (counter.innerText !== nextValue.toString()) {
        counter.innerText = nextValue;
      }
      setTimeout(() => requestAnimationFrame(animateCounter), frameRate);
    } else {
      counter.innerText = target;
    }
  }

  // Intersection Observer with options for better performance
  const observer = new IntersectionObserver(
    entries => {
      if (entries[0].isIntersecting) {
        requestAnimationFrame(animateCounter);
        observer.disconnect();
      }
    },
    { threshold: 0.1 }
  );

  observer.observe(counter);
</script>

<!-- Modal -->
{% if celebration_enabled %}
<div id="thanksModal" class="flex fixed inset-0 justify-center items-center opacity-0 transition-opacity duration-300 pointer-events-none" style="z-index: 11000;">
    <div class="absolute inset-0 bg-black bg-opacity-50 backdrop-blur-sm"></div>
    <div class="relative p-8 mx-4 w-full max-w-md bg-white rounded-lg shadow-xl transition-transform duration-300 transform scale-95">
        <button id="closeModal" class="absolute top-4 right-4 text-gray-400 transition-colors duration-200 hover:text-gray-600">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
        </button>
        <h2 class="mb-4 text-2xl font-bold text-center text-green-600">Danke für Ihren Beitrag! 💚</h2>
        <div class="mb-6 mantis">
            <img id="dancingMantis" src="https://www.svgrepo.com/show/481511/praying-mantis-2.svg" alt="Gottesanbeterin" class="mx-auto w-32 h-32">
            <span class="magnifier" role="img" aria-label="Lupe">🔍</span>
        </div>
        <p class="mb-6 text-lg text-center text-gray-700">{{ celebration_threshold }} Meldungen erreicht! Ihre Unterstützung ist wertvoll für unsere Forschung.</p>
        <div class="flex justify-center">
            <button id="moreConfetti" class="px-6 py-3 text-white bg-green-500 rounded-full shadow-md transition-colors duration-200 hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2">
                <span class="mr-2">Feiern!</span>
                <span role="img" aria-label="Konfetti">🎉</span>
            </button>
        </div>
    </div>
</div>

<script src="{{ url_for('static', filename='node_modules/canvas-confetti/dist/confetti.browser.js')}}"></script>

<script>
    function sprayConfetti() {
        confetti({
            particleCount: 100,
            spread: 70,
            origin: { y: 0.6 }
        });
    }

    function fireworks() {
        var duration = 15 * 1000;
        var animationEnd = Date.now() + duration;
        var defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 0 };

        function randomInRange(min, max) {
            return Math.random() * (max - min) + min;
        }

        var interval = setInterval(function() {
            var timeLeft = animationEnd - Date.now();

            if (timeLeft <= 0) {
                return clearInterval(interval);
            }

            var particleCount = 50 * (timeLeft / duration);
            confetti({ ...defaults, particleCount, origin: { x: randomInRange(0.1, 0.3), y: Math.random() - 0.2 } });
            confetti({ ...defaults, particleCount, origin: { x: randomInRange(0.7, 0.9), y: Math.random() - 0.2 } });
        }, 250);
    }

    function danceMantis() {
        const mantis = document.getElementById('dancingMantis');
        mantis.classList.add('dancing');
        setTimeout(() => mantis.classList.remove('dancing'), 1000);
    }

    function openModal() {
        const modal = document.getElementById('thanksModal');
        modal.classList.remove('opacity-0', 'pointer-events-none');
        modal.querySelector('div:nth-child(2)').classList.remove('scale-95');
        document.body.style.overflow = 'hidden';
        sprayConfetti();
        fireworks();
        danceMantis();
    }

    function closeModal() {
        const modal = document.getElementById('thanksModal');
        modal.classList.add('opacity-0', 'pointer-events-none');
        modal.querySelector('div:nth-child(2)').classList.add('scale-95');
        document.body.style.overflow = '';
    }

    // Open modal on page load only if celebration is enabled
    window.addEventListener('load', () => {
        setTimeout(openModal, 1000); // Delay modal opening by 1 second
    });

    // Close modal when the close button is clicked
    document.getElementById('closeModal').addEventListener('click', closeModal);

    // Spray more confetti and make mantis dance when the button is clicked
    document.getElementById('moreConfetti').addEventListener('click', () => {
        sprayConfetti();
        danceMantis();
    });
</script>

<style>
    canvas {
        z-index: 12000 !important;
    }

    
    .mantis {
        position: relative;
        width: 150px;
        height: 150px;
        margin: 0 auto;
    }
    .magnifier {
        position: absolute;
        top: 29%;
        left: 19%;
        font-size: 1.5em;
    }
    @keyframes dance {
        0%, 100% { transform: rotate(0deg); }
        25% { transform: rotate(-15deg); }
        75% { transform: rotate(15deg); }
    }
    .dancing {
        animation: dance 0.5s ease-in-out infinite;
    }
</style>
{% endif %}
{% endblock content %}
